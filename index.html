<!DOCTYPE html>

<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Gerador de Ofertas</title>

<style>
body{
margin:0;
font-family:Arial, Helvetica, sans-serif;
background:linear-gradient(180deg,#07121f,#0b2440);
color:white;
text-align:center;
}

.container{
max-width:420px;
margin:20px auto;
background:#0f2b4a;
padding:18px;
border-radius:18px;
box-shadow:0 10px 30px rgba(0,0,0,.4);
}

input, textarea{
width:100%;
padding:12px;
margin:6px 0;
border-radius:12px;
border:none;
font-size:14px;
}

button{
width:100%;
padding:14px;
margin-top:10px;
border:none;
border-radius:14px;
font-weight:bold;
font-size:16px;
cursor:pointer;
}

.gerar{background:#00a650;color:white;}
.baixar{background:#1b4dff;color:white;display:none;}

#resultado{
width:95%;
margin-top:18px;
border-radius:14px;
display:none;
}

canvas{display:none;}
</style>

</head>

<body>

<div class="container">
<h2>Gerar oferta</h2>

<input type="file" id="foto" accept="image/*">
<input type="file" id="logo" accept="image/*">

<input type="text" id="nome" placeholder="Nome do produto">
<input type="text" id="gramas" placeholder="Peso ex: 500g">
<input type="text" id="preco" placeholder="Preço ex: 12,99">
<textarea id="descricao" placeholder="Descrição"></textarea>

<input type="text" id="loja" placeholder="Nome da loja">
<input type="text" id="whats" placeholder="WhatsApp">

<button class="gerar" onclick="gerar()">Gerar arte</button> <button class="baixar" id="baixarBtn" onclick="baixar()">Baixar imagem</button>

<img id="resultado">
<canvas id="c"></canvas>
</div>

<script>

function carregarImagem(file){
return new Promise((resolve,reject)=>{
if(!file) return resolve(null);

const reader=new FileReader();
reader.onload=e=>{
const img=new Image();
img.onload=()=>resolve(img);
img.onerror=reject;
img.src=e.target.result;
};
reader.readAsDataURL(file);
});
}

let lastDataUrl="";

async function gerar(){

const nome=document.getElementById("nome").value||"Produto";
const gramas=document.getElementById("gramas").value||"";
const descricao=document.getElementById("descricao").value||"";
const preco=document.getElementById("preco").value||"";
const loja=document.getElementById("loja").value||"";
const whats=document.getElementById("whats").value||"";

const fileProd=document.getElementById("foto").files[0];
const fileLogo=document.getElementById("logo").files[0];

if(!fileProd){
alert("Escolha a foto do produto");
return;
}

const prodImg=await carregarImagem(fileProd);
const logoImg=await carregarImagem(fileLogo);

const canvas=document.getElementById("c");
const ctx=canvas.getContext("2d");

canvas.width=1080;
canvas.height=1080;

ctx.fillStyle="#ffffff";
ctx.fillRect(0,0,1080,1080);

ctx.drawImage(prodImg,140,120,800,480);

ctx.fillStyle="#111";
ctx.font="bold 60px Arial";
ctx.fillText(nome,120,720);

ctx.font="40px Arial";
ctx.fillText(gramas,120,780);

ctx.font="36px Arial";
ctx.fillText(descricao,120,830);

ctx.fillStyle="#FFD400";
ctx.fillRect(120,860,840,150);

ctx.fillStyle="#111";
ctx.font="bold 120px Arial";
ctx.fillText("R$ "+preco,160,975);

ctx.font="32px Arial";
ctx.fillText(loja+" • "+whats,120,1040);

if(logoImg){
ctx.drawImage(logoImg,820,40,200,120);
}

lastDataUrl=canvas.toDataURL("image/png");

const out=document.getElementById("resultado");
out.src=lastDataUrl;
out.style.display="block";
document.getElementById("baixarBtn").style.display="block";
}

function baixar(){
const a=document.createElement("a");
a.href=lastDataUrl;
a.download="oferta.png";
a.click();
}

</script>

</body>
</html>
